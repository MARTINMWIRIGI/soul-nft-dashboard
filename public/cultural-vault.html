<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cultural & Linguistic Vault</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@nftstorage/nft-storage/dist/bundle.esm.min.js" type="module"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/face-api.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fdfdfd;
      margin: 0;
      padding: 0;
      color: #222;
    }
    header {
      background: #1a1a1a;
      color: #fff;
      padding: 1rem;
      text-align: center;
    }
    h1 { font-size: 1.6rem; margin: 0; }
    .container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1rem;
      padding: 1rem;
    }
    .card {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 12px;
      padding: 1rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .card h2 {
      font-size: 1.2rem;
      margin-bottom: .5rem;
      text-align: center;
    }
    .card button, .card input {
      margin-top: .5rem;
      padding: .6rem 1rem;
      border: none;
      border-radius: 8px;
      background: #0077ff;
      color: #fff;
      cursor: pointer;
      font-size: .9rem;
    }
    .card button:hover { background: #005fcc; }
    video, audio {
      max-width: 100%;
      border-radius: 8px;
      margin-top: .5rem;
    }
    footer {
      text-align: center;
      padding: 1rem;
      font-size: .8rem;
      background: #f1f1f1;
    }
    /* Mobile adjustments */
    @media (max-width: 600px) {
      h1 { font-size: 1.3rem; }
      .card h2 { font-size: 1rem; }
      .card button { font-size: .8rem; padding: .5rem .8rem; }
    }
  </style>
</head>
<body>

<header class="header" style="display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:#111;position:relative;">
  <div class="logo" style="display:flex;align-items:center;gap:8px;font-weight:bold;color:white;">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
      <rect x="3" y="3" width="7" height="7" fill="white"/>
      <rect x="14" y="3" width="7" height="7" fill="white"/>
      <rect x="3" y="14" width="7" height="7" fill="white"/>
      <rect x="14" y="14" width="7" height="7" fill="white"/>
    </svg>
    <span style="font-weight:bold;font-size:18px;color:white;">Soul Internet</span>
  </div>

  <!-- Navigation links (desktop) -->
  

  <div class="header-right" style="display:flex;align-items:center;gap:12px;">
    <!-- Wallet Button -->
    <button onclick="connectWallet()" id="walletBtn" 
      style="background:#4CAF50;color:white;padding:8px 14px;border:none;border-radius:6px;cursor:pointer;font-weight:bold;">
      Connect Wallet
    </button>

    <!-- Hamburger -->
    <button class="menu-btn" onclick="toggleMenu()" style="background:none;border:none;cursor:pointer;">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M3 12h18M3 6h18M3 18h18" stroke="white" stroke-width="2" stroke-linecap="round"/>
      </svg>
    </button>
  </div>
</header>

<!-- Mobile Dropdown -->
<div id="mobileMenu" style="display:none;flex-direction:column;position:absolute;top:60px;right:16px;background:white;padding:16px;border-radius:8px;box-shadow:0 4px 8px rgba(0,0,0,0.2);z-index:1000;">
  <a href="/" style="color:blue;font-weight:bold;text-decoration:none;margin:8px 0;">Home</a>
  <a href="/cultural-vault.html" style="color:blue;font-weight:bold;text-decoration:none;margin:8px 0;">Cultural Vault</a>
  <button onclick="connectWallet()" id="walletBtnMobile" 
    style="background:#4CAF50;color:white;padding:8px 14px;border:none;border-radius:6px;cursor:pointer;font-weight:bold;margin-top:10px;">
    Connect Wallet
  </button>
</div>

<script>
function toggleMenu() {
  const menu = document.getElementById("mobileMenu");
  menu.style.display = (menu.style.display === "flex") ? "none" : "flex";
}

// MetaMask connect
async function connectWallet() {
  if (typeof window.ethereum !== "undefined") {
    try {
      const accounts = await window.ethereum.request({ method: "eth_requestAccounts" });
      const shortAddress = accounts[0].slice(0,6) + "..." + accounts[0].slice(-4);

      // Update both desktop and mobile buttons
      const walletBtn = document.getElementById("walletBtn");
      const walletBtnMobile = document.getElementById("walletBtnMobile");
      if (walletBtn) {
        walletBtn.innerText = "Connected: " + shortAddress;
        walletBtn.style.background = "#2E7D32";
      }
      if (walletBtnMobile) {
        walletBtnMobile.innerText = "Connected: " + shortAddress;
        walletBtnMobile.style.background = "#2E7D32";
      }
    } catch (err) {
      alert("Connection failed: " + err.message);
    }
  } else {
    alert("MetaMask not detected. Please install MetaMask.");
  }
}
</script>
  
  
  <header>
    <h1>Cultural & Linguistic Vault</h1>
    <p>Preserve languages, traditions, and heritage on-chain</p>
  </header>

  <div class="container">

<!-- ðŸŽ™ Voice Recording Layer Intro (Cultural Vault Section) -->

    
<section style="margin-bottom:2.5rem;">
  <div style="
    padding:1.5rem; 
    border-radius:1rem; 
    background:linear-gradient(90deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02)); 
    border:1px solid rgba(255,255,255,0.08); 
    box-shadow:0 4px 20px rgba(0,0,0,0.4); 
    color:#f1f5f9; 
    font-family:sans-serif;">
    
    <h2 style="font-size:1.875rem; font-weight:800; color: blue; margin-bottom:0.5rem;">ðŸŽ™Eternal Voicesâœ¨</h2>
    <p style="font-size:1.125rem; color: red; font-weight:bold; margin-bottom:1rem;">Speak once, live forever.</p>
    <p style="color:black; line-height:1.6; margin-bottom:1.5rem;">
      Your voice is your signature, your truth.
      Dialects, prayers, chants, and everyday speech
      every voice carries roots.
      <br><br>
      Record it, Declare it, and Preserve it as a sacred capsule.
      On-chain, it becomes immortal.
      <br><br>
      The blockchain remembers what time forgets.
      Create an unbroken chain of memory,
      where future generations can still hear the songs of today.
      <br>
    </p>

    <a href="voice.html" 
       style="
        display:inline-flex; 
        align-items:center; 
        gap:0.5rem;
        background-color:red; 
        color:white; 
        font-weight:600; 
        padding:0.75rem 1.5rem; 
        border-radius:9999px; 
        text-decoration:none; 
        box-shadow:0 0 15px rgba(139,92,246,0.6), 0 0 30px rgba(139,92,246,0.3); 
        animation:pulseGlow 2.8s infinite; 
        transition:all 0.3s ease;">
      ðŸŽ§ Open Voice Layer
      <!-- Equalizer bars -->
      <span style="display:inline-flex; gap:2px; align-items:flex-end; height:16px;">
        <span style="width:2px; height:8px; background:white; display:inline-block; animation:barAnim 1s infinite ease-in-out;"></span>
        <span style="width:2px; height:12px; background:white; display:inline-block; animation:barAnim 1s infinite ease-in-out 0.2s;"></span>
        <span style="width:2px; height:6px; background:white; display:inline-block; animation:barAnim 1s infinite ease-in-out 0.4s;"></span>
      </span>
    </a>
  </div>
</section>

<!-- Inline Animations -->
<style>
@keyframes pulseGlow {
  0%, 100% {
    box-shadow:0 0 15px rgba(139,92,246,0.6), 0 0 30px rgba(139,92,246,0.3);
    transform:scale(1);
  }
  50% {
    box-shadow:0 0 25px rgba(139,92,246,0.9), 0 0 45px rgba(139,92,246,0.5);
    transform:scale(1.05);
  }
}
@keyframes barAnim {
  0%, 100% { transform:scaleY(0.4); }
  50% { transform:scaleY(1); }
}
</style>
    


    <!-- Voice Recognition -->


<!-- Facial Recognition Layer Intro -->
<section style="
  background:rgba(255,255,255,0.02);
  border:1px solid rgba(255,255,255,0.06);
  border-radius:1rem;
  padding:2rem;
  margin:2rem auto;
  max-width:900px;
  text-align:center;
  box-shadow:0 0 25px rgba(124,58,237,0.25), 0 0 45px rgba(6,182,212,0.15);
">
  <h2 style="font-size:2rem; font-weight:800; color:blue; margin-bottom:0.5rem;">
    The Moment of Recognition
  </h2>
  <p style="font-size:1.2rem; color:red; font-weight:bold;  margin-bottom:1.5rem;">
     Let the vault see you.
  </p>

  <!-- Visual Face Scanner Preview -->
  <div style="
    width:200px;
    height:200px;
    margin:0 auto 1.5rem;
    border-radius:50%;
    background:radial-gradient(circle at center, rgba(124,58,237,0.3), rgba(6,182,212,0.15), transparent);
    display:flex;
    align-items:center;
    justify-content:center;
    position:relative;
    overflow:hidden;
    box-shadow:0 0 25px rgba(124,58,237,0.5), inset 0 0 30px rgba(6,182,212,0.2);
  ">
    <span class="face-icon" style="font-size:4rem; color:#e2e8f0;">ðŸ‘¤</span>
    <div style="
      position:absolute;
      top:0;
      left:0;
      right:0;
      height:3px;
      background:linear-gradient(90deg,#7c3aed,#06b6d4);
      animation:scanLine 3s linear infinite;
      opacity:0.85;
    "></div>
  </div>

  <p style="color:black; font-size:1rem; line-height:1.6; max-width:700px; margin:0 auto 1.5rem;">
    This is no ordinary scan â€” it is a ritual of remembrance.  
    Sit steady, breathe calmly, and let the scanner pass across your face.  
    What it captures is not vanity, but proof:  
    evidence that you walked, you lived, you dreamed.  
    Once sealed, your image becomes a timeless capsule,  
    preserved forever on the blockchain.  
  </p>

  <a href="face.html" style="
    display:inline-block;
    background:linear-gradient(90deg,#7c3aed,#06b6d4);
    color:#fff;
    padding:0.75rem 2rem;
    border-radius:9999px;
    font-weight:600;
    text-decoration:none;
    box-shadow:0 0 20px rgba(124,58,237,0.5), 0 0 30px rgba(6,182,212,0.3);
    transition:all 0.3s ease;
  " onmouseover="this.style.opacity='0.9'" onmouseout="this.style.opacity='1'">
    Open Facial Layer
  </a>
</section>

<!-- Inline animations -->
<style>
@keyframes scanLine {
  0% { top:0%; }
  100% { top:100%; }
}
@keyframes pulse {
  0%, 100% { transform: scale(1); opacity:1; }
  50% { transform: scale(1.08); opacity:0.8; }
}
.face-icon {
  display:inline-block;
  animation: pulse 2.5s ease-in-out infinite;
}
</style>
    
    

<!-- Facial Recognition -->





    <!-- Steps Recording -->
    <!-- Steps Recording Intro -->
<section style="
  background:rgba(255,255,255,0.02);
  border:1px solid rgba(255,255,255,0.06);
  border-radius:1rem;
  padding:2rem;
  margin:2rem auto;
  max-width:900px;
  text-align:center;
  box-shadow:0 0 25px rgba(124,58,237,0.25), 0 0 45px rgba(6,182,212,0.15);
  position:relative;
  overflow:hidden;
">
  <h2 style="font-size:2rem; font-weight:800; color:blue; margin-bottom:0.5rem;">
    Steps Into Eternity
  </h2>
  <p style="font-size:1.2rem; color:red; font-weight:bold; font-style:italic; margin-bottom:1.5rem;">
    Every step is a story â€” let the vault remember yours.
  </p>

  <!-- Animated footsteps row + glowing path -->
  <div style="display:flex;justify-content:center;align-items:center;gap:2rem;position:relative;margin:1.5rem 0;">
    <!-- glowing line between footsteps -->
    <div class="footstep-path"></div>

    <span class="footstep">ðŸ‘£</span>
    <span class="footstep delay">ðŸ‘£</span>
  </div>

  <p style="color:black; font-size:1rem; line-height:1.6; max-width:700px; margin:0 auto 1.5rem;">
    Dances, rituals, and footsteps are not just movement â€” they are memory encoded in rhythm.  
    Each step you take becomes a glowing trace, sealed inside the vault as cultural choreography.  
    What begins as motion will echo as <span style="color:red;font-weight:600;">immortal rhythm</span>, preserved forever on-chain.
  </p>

  <a href="steps.html" style="
    display:inline-block;
    background:linear-gradient(90deg,#06b6d4,#3b82f6);
    color:#fff;
    padding:0.75rem 2rem;
    border-radius:9999px;
    font-weight:600;
    text-decoration:none;
    box-shadow:0 0 20px rgba(6,182,212,0.5), 0 0 30px rgba(59,130,246,0.3);
    transition:all 0.3s ease;
    animation:buttonPulse 2s infinite;
  " onmouseover="this.style.opacity='0.9'" onmouseout="this.style.opacity='1'">
    Open Steps Layer
  </a>
</section>

<!-- Inline animations -->
<style>
  .footstep {
    font-size:3rem;
    display:inline-block;
    animation: stepPulse 2s infinite;
    z-index:2;
  }
  .footstep.delay {
    animation-delay:1s;
  }

  /* glowing path line */
  .footstep-path {
    position:absolute;
    left:50%;
    top:50%;
    transform:translate(-50%,-50%);
    width:140px; /* distance between footsteps */
    height:4px;
    background:linear-gradient(90deg, rgba(124,58,237,0.8), rgba(6,182,212,0.8));
    border-radius:2px;
    box-shadow:0 0 20px rgba(124,58,237,0.6), 0 0 30px rgba(6,182,212,0.5);
    animation:pathGlow 2s infinite alternate;
    z-index:1;
  }

  @keyframes stepPulse {
    0%,100% { transform: scale(0.8); opacity:0.6; }
    40% { transform: scale(1.2); opacity:1; }
    70% { transform: scale(1); opacity:0.8; }
  }
  @keyframes buttonPulse {
    0%,100% { transform: scale(1); box-shadow:0 0 15px rgba(6,182,212,0.5), 0 0 30px rgba(59,130,246,0.4); }
    40% { transform: scale(1.05); box-shadow:0 0 25px rgba(6,182,212,0.7), 0 0 50px rgba(59,130,246,0.6); }
    70% { transform: scale(1.02); box-shadow:0 0 18px rgba(6,182,212,0.6), 0 0 35px rgba(59,130,246,0.5); }
  }
  @keyframes pathGlow {
    from { opacity:0.5; }
    to { opacity:1; }
  }
</style>



    

    <!-- Document Upload -->
    <div class="card">
      <h2>Upload Document</h2>
      <input type="file" id="docUpload">
      <button onclick="uploadDoc()">Upload & Mint</button>
    </div>
  </div>

  <footer>
    Contributor: 0x8Cbe46A175E9CE3bB9FCF1F739F8C6b37d3308b3 Â· Vault Contract: 0x4df55fad5af6ce9238d5d43f1589bc52cbea7b82
  </footer>

  <script type="module">
    import { NFTStorage, File } from "https://cdn.jsdelivr.net/npm/@nftstorage/nft-storage/dist/bundle.esm.min.js";
    
    const NFT_STORAGE_KEY = "e45adb75.7c576e66ce6d497d853b61f4645f9039";
    const CONTRACT_ADDRESS = "0x4df55fad5af6ce9238d5d43f1589bc52cbea7b82";
    const CONTRIBUTOR = "0x8Cbe46A175E9CE3bB9FCF1F739F8C6b37d3308b3";

    // === FACE RECOGNITION ===
    async function startFace() {
      await faceapi.nets.tinyFaceDetector.loadFromUri('/models');
      const video = document.getElementById('video');
      navigator.mediaDevices.getUserMedia({ video: true })
        .then(stream => video.srcObject = stream);
      video.addEventListener('play', () => {
        const canvas = faceapi.createCanvasFromMedia(video);
        document.body.append(canvas);
        setInterval(async () => {
          const detections = await faceapi.detectAllFaces(video, new faceapi.TinyFaceDetectorOptions());
          canvas.getContext('2d').clearRect(0, 0, canvas.width, canvas.height);
          faceapi.draw.drawDetections(canvas, detections);
        }, 200);
      });
    }

    // === VIDEO RECORD ===
    let vidRecorder, vidChunks = [];
    function startVideoRecord() {
      navigator.mediaDevices.getUserMedia({ video: true }).then(stream => {
        vidRecorder = new MediaRecorder(stream);
        vidRecorder.ondataavailable = e => vidChunks.push(e.data);
        vidRecorder.onstop = () => {
          const blob = new Blob(vidChunks, { type: 'video/mp4' });
          document.getElementById('danceVideo').src = URL.createObjectURL(blob);
          vidChunks = [];
        };
        vidRecorder.start();
        setTimeout(() => vidRecorder.stop(), 5000);
      });
    }

    // === AUDIO RECORD ===
    let audRecorder, audChunks = [];
    function startAudio() {
      navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {
        audRecorder = new MediaRecorder(stream);
        audRecorder.ondataavailable = e => audChunks.push(e.data);
        audRecorder.onstop = () => {
          const blob = new Blob(audChunks, { type: 'audio/mp3' });
          document.getElementById('audioPlay').src = URL.createObjectURL(blob);
          audChunks = [];
        };
        audRecorder.start();
        setTimeout(() => audRecorder.stop(), 4000);
      });
    }

    // === DOCUMENT UPLOAD + NFT ===
    async function uploadDoc() {
      const fileInput = document.getElementById('docUpload');
      if (!fileInput.files.length) return alert("Upload a file first!");
      const file = fileInput.files[0];

      const client = new NFTStorage({ token: NFT_STORAGE_KEY });
      const metadata = await client.store({
        name: file.name,
        description: "Cultural Document Upload",
        image: new File([file], file.name, { type: file.type })
      });

      alert("Uploaded to IPFS: " + metadata.url);
      await mintNFT(metadata.url);
    }

    async function mintNFT(tokenURI) {
      if (!window.ethereum) return alert("Please install MetaMask");
      const provider = new ethers.providers.Web3Provider(window.ethereum);
      await provider.send("eth_requestAccounts", []);
      const signer = provider.getSigner();
      const abi = [
        "function safeMint(address to, string memory uri) public"
      ];
      const contract = new ethers.Contract(CONTRACT_ADDRESS, abi, signer);
      const tx = await contract.safeMint(CONTRIBUTOR, tokenURI);
      await tx.wait();
      alert("NFT Minted successfully!");
    }

    // expose funcs
    window.startFace = startFace;
    window.startVideoRecord = startVideoRecord;
    window.startAudio = startAudio;
    window.uploadDoc = uploadDoc;
  </script>
</body>
  </html>
  
